\begin{minipage}
\centering
\begin{lstlisting}[mathescape, linewidth=11.8cm]
shared variables: boolean
                  barrier[processCount][processCount]
local variables:  integer dist
initialization:   barrier[*][*] := false
$\listingrule{11.8cm}$

for dist := 1; dist < processCount; dist := dist $\times$ 2 {
	to   := (processIndex + dist) (mod processCount)
	from := (processIndex - dist) (mod processCount)
	
	barrier[to][processIndex] := true
	
	wait until barrier[processIndex][from] = true
}
\end{lstlisting}
\end{minipage}
