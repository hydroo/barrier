\begin{lstlisting}[mathescape]
shared variables: boolean
                  barrier[processCount][processCount]
local variables:  integer dist
initialization:   barrier[*][*] := false

for dist := 1; dist < numThreads; dist := dist $\times$ 2 {
	to   := (processIndex + dist) (mod processCount)
	from := (processIndex - dist) (mod processCount)
	
	barrier[to][processIndex] := true
	
	wait until barrier[processIndex][from] = true
}
\end{lstlisting}

