\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[mathescape, linewidth=10.2cm]
shared variables: integer barrier := threadCount
$\listingrule{10.2cm}$

atomic{barrier := barrier - 1}

wait until barrier = 0
\end{lstlisting}
\end{minipage}
\end{center}
