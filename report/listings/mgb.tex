\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[mathescape, linewidth=11.0cm]
constants:        me:=$2^\mathit{threadIndex}$, full:=$\sum_{i=0}^{\mathit{threadCount}-1}2^i$
local variables:  integer copy
shared variables: integer first, second, done
initialisation:   first := 0, second := 0, done := 2
$\listingrule{11.0cm}$

if done = 2 {

	do {
		copy := (copy $\&$ $\sim$me) | first
		if copy $\&$ me = 0 {
			copy  := copy | me
			first := copy
		}
	} while copy $\neq$ full and done = 2

	done   := 1
	second := 0

} else if done = 1 {

	do {
		copy := (copy $\&$ $\sim$me) | second
		if copy $\&$ me = 0 {
			copy := copy | me
			second := copy
		}
	} while copy $\neq$ full and done = 1

	done  := 2
	first := 0
}
\end{lstlisting}
\end{minipage}
\end{center}
