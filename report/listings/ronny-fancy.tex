\begin{minipage}
\centering
\begin{lstlisting}[mathescape, linewidth=11.5cm]
constants:        me := processIndex, meBit := $2^{me}$,
                  full := $\sum_{i=0}^{\mathit{processCount}-1}2^i$
shared variables: integer barrier[processCount]
local variables:  integer i
initialization:   barrier[*] := 0
                  i := processIndex
$\listingrule{11.5cm}$

barrier[me] := meBit;

do {
	do {
		i := i + 1 (mod processCount)
	} while barrier[me] & $2^i$ = 1

	barrier[me] := barrier[me] | barrier[i]
} while barrier[me] $\neq$ full
\end{lstlisting}
\end{minipage}
