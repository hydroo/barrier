\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[mathescape, linewidth=11.2cm]
constants:        me := processIndex
shared variables: boolean
                  barrier[processCount][processCount]
local variables:  integer dist, to, from
initialization:   barrier[*][*] := false
$\listingrule{11.2cm}$

dist := 1
while dist < processCount {
	to   := (me + dist) (mod processCount)
	from := (me - dist) (mod processCount)
	
	barrier[to][me] := true
	
	wait until barrier[me][from] = true

	dist := dist $\cdot$ 2
}
\end{lstlisting}
\end{minipage}
\end{center}
