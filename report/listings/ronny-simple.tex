\begin{minipage}
\centering
\begin{lstlisting}[mathescape, linewidth=10.1cm]
shared variables: boolean barrier[threadCount]
local variables:  integer i
initialization:   barrier[*] := false
$\listingrule{10.1cm}$

barrier[threadIndex] := true

for i := 0; i < threadCount; i := i + 1 {
	if barrier[i] = false {
		i := -1
	}
}
\end{lstlisting}
\end{minipage}
