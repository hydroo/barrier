\begin{center}
\begin{minipage}{\textwidth}
\begin{lstlisting}[mathescape, linewidth=10.7cm]
constants:        me := processIndex, meBit := $2^{me}$,
                  full := $\sum_{i=0}^{\mathit{processCount}-1}2^i$
shared variables: integer barrier[processCount]
local variables:  integer i
initialisation:   barrier[*] := 0
                  i := processIndex
$\listingrule{10.7cm}$

barrier[me] := meBit

do {
	do {
		i := i + 1 (mod processCount)
	} while barrier[me] $\&$ $2^i$ = 1

	barrier[me] := barrier[me] | barrier[i]
} while barrier[me] $\neq$ full
\end{lstlisting}
\end{minipage}
\end{center}
