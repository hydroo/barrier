\begin{minipage}
\centering
\begin{lstlisting}[mathescape, linewidth=11.5cm]
constants:        me := processIndex, meBit := $2^{me}$,
                  full := $\sum_{i=0}^{\mathit{processCount}-1}2^i$
shared variables: integer barrier[processCount]
initialization:   barrier[*] := 0
$\listingrule{11.5cm}$

barrier[me] := meBit;

i := processIndex + 1 (mod processCount)
do {
	while barrier[me] & $2^i$ == 1 and i < processCount {
		i := i + 1
	}

	if i < processCount {
		barrier[me] := barrier[me] | barrier[i]
	} else {
		i := 0
	}
} while barrier[me] $\neq$ full
\end{lstlisting}
\end{minipage}
